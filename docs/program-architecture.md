# Архитектура компилятора TS

## Общее описание

Данная программа представляет собой LL-парсер для синтаксического анализа выражений. Программа работает по следующему принципу:

1. Чтение правил грамматики из файла
2. Построение направляющих множеств для правил грамматики
3. Построение таблицы парсинга на основе правил с направляющими множествами
4. Создание LL-парсера с использованием созданной таблицы
5. Интерактивный анализ выражений, введенных пользователем
## Основные компоненты

### 1. Лексический анализатор (Lexer)

Лексический анализатор разбивает входную строку на токены - минимальные значимые единицы языка.

**Реализация**: `src/lexer/Lexer.ts`

**Основные функции**:
- `get()` - получение следующего токена
- `peek()` - просмотр следующего токена без его удаления из потока
- `empty()` - проверка достижения конца входной строки

Лексер опирается на набор правил для распознавания различных типов токенов:
- Идентификаторы (`Id.ts`)
- Числа (`Number.ts`)
- Зарезервированные слова (`ReservedWords.ts`)
- Строковые литералы (`String.ts`)
- Специальные символы (`SpecialChars.ts`)

Лексер использует класс `Reader` для чтения входной строки посимвольно.

### 2. Построитель направляющих множеств (GuidesBuilder)

Направляющие множества помогают определить, какое правило грамматики следует применить в зависимости от текущего токена.

**Реализация**: `src/guidesBuilder/GuidesBuilder.ts`

**Основные функции**:
- `buildGuidedRules()` - построение правил с направляющими множествами
- `buildRelationFirst()` - построение отношения First
- `getFollow()` - получение Follow множества для нетерминала
- `transitiveClosure()` - построение транзитивного замыкания

### 3. Построитель таблицы парсинга (TableBuilder)

Создает таблицу для LL-парсера на основе правил грамматики с направляющими множествами.

**Реализация**: `src/tableBuilder/TableBuilder.ts`

**Основные функции**:
- `buildTable()` - построение таблицы парсинга
- `fillLeftNonTerms()` - заполнение левой части таблицы нетерминалами
- `fillRightSides()` - заполнение правой части таблицы
- `fillAlternative()` - заполнение таблицы для одной альтернативы

### 4. LL-парсер (LLParser)

Выполняет синтаксический анализ входной строки с использованием созданной таблицы.

**Реализация**: `src/LLParser/LLParser.ts`

**Основные функции**:
- `parse()` - анализ входной строки
- `getError()` - получение информации об ошибке
- `shift()` - получение следующего токена и обновление текущего символа

## Порядок работы программы

1. Программа запускается из `src/index.ts`, который является точкой входа
2. Разбираются аргументы командной строки для получения пути к файлу с правилами грамматики
3. Из файла считываются правила грамматики
4. Создается объект `GuidesBuilder` для построения направляющих множеств
5. Создается объект `TableBuilder` для построения таблицы парсинга
6. Создается объект `LLParser` с использованием созданной таблицы
7. Программа ожидает ввода выражений от пользователя для анализа
8. Для каждого введенного выражения:
   - Вызывается метод `parse()` для анализа
   - Выводится результат анализа (успех или ошибка)

## Подробное описание алгоритма синтаксического анализа

1. **Инициализация**:
   - Создание лексического анализатора для входной строки
   - Установка начального индекса таблицы
   - Очистка стека и информации об ошибках

2. **Основной цикл**:
   - Получение текущей строки таблицы
   - Проверка наличия текущего символа в направляющих множествах строки
   - Если символа нет в направляющих множествах и строка отмечена как ошибочная, фиксируется ошибка
   - Если достигнут конец грамматики, анализ завершается успешно
   - Если требуется сдвиг, получается следующий токен
   - Если требуется сохранение состояния, индекс помещается в стек
   - Переход к следующей строке таблицы согласно указателю или стеку

3. **Обработка ошибок**:
   - При обнаружении ошибки фиксируется ожидаемое и полученное значение
   - Результат анализа в этом случае - false

## Структура данных таблицы

Таблица представляет собой массив строк, каждая из которых содержит:
- `symbol` - символ грамматики (терминал или нетерминал)
- `guides` - направляющие множества для данного символа
- `shift` - флаг необходимости получения следующего токена
- `error` - флаг, указывающий на то, что строка может быть ошибочной
- `ptr` - указатель на следующую строку таблицы
- `stack` - флаг необходимости сохранения состояния в стеке
- `end` - флаг достижения конца грамматики

## Работа с грамматикой

Грамматика задается в виде правил в формате:
```
<нетерминал> - <альтернатива> / <направляющие множества>
```

Например:
```
<S> - <A> / a c
<S> - b <B> / b
<A> - a / a
<A> - c / c
<B> - b / b
```

Такой формат позволяет явно указать, какие терминалы могут следовать за каждым правилом, что упрощает процесс построения таблицы парсинга.

## Обработка ошибок

Программа обрабатывает различные типы ошибок:
- Лексические ошибки (неизвестный символ, неверный формат числа и т.д.)
- Синтаксические ошибки (несоответствие грамматике)

При обнаружении ошибки программа выводит информацию о том, какой токен ожидался и какой был получен.