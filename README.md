# TypeScript Compiler

Это реализация компилятора, переписанного с C++ на TypeScript. Проект включает лексический анализатор и другие компоненты компилятора.

## Установка

```bash
npm install
```

## Сборка

```bash
npm run build
```

## Запуск

```bash
npm start <путь_к_файлу_правил>
```

Приложение будет читать правила из указанного файла и затем ожидать ввода выражений в консоли для анализа.

## Запуск тестов

```bash
npm test
```

## Структура проекта

- `src/` - исходный код
  - `errors/` - коды ошибок
  - `lexer/` - лексический анализатор
    - `reader/` - модуль для чтения входного потока
    - `rules/` - правила для лексического анализа
    - `token/` - определения токенов
  - `parser/` - синтаксический анализатор
  - `guidesBuilder/` - построитель направляющих множеств
  - `tableBuilder/` - построитель таблицы
  - `LLParser/` - LL-парсер
  - `print/` - вспомогательные функции вывода
  - `table/` - структуры данных для таблиц
- `tests/` - тесты
  - `lexer/` - тесты лексического анализатора
  - `parser/` - тесты синтаксического анализатора
  - `guidesBuilder/` - тесты построителя направляющих множеств
  - `tableBuilder/` - тесты построителя таблицы
  - `LLParser/` - тесты LL-парсера

## Реализованные компоненты

### Полностью реализованные модули

1. **Лексический анализатор** (`Lexer`) - Разбивает входной текст на токены. Включает:
   - Чтение входного потока символов (`Reader`)
   - Правила для распознавания идентификаторов, чисел, строк, специальных символов
   - Обработку зарезервированных слов

2. **Синтаксический анализатор** (`Parser`) - Проверяет соответствие входной строки грамматике:
   - Правила для разбора выражений
   - Правила для идентификаторов и списков выражений
   - Обработка операций с учетом приоритета

3. **Построитель направляющих множеств** (`GuidesBuilder`) - Генерирует направляющие множества из грамматики:
   - Парсер сырых правил грамматики
   - Построение отношения First и Follow
   - Транзитивное замыкание для вычисления всех направляющих множеств

4. **Построитель таблицы** (`TableBuilder`) - Строит таблицу для LL-парсера:
   - Парсер правил с направляющими множествами
   - Заполнение левой и правой части таблицы
   - Обработка альтернатив и определение аксиом грамматики

5. **LL-парсер** (`LLParser`) - Синтаксический анализ на основе таблицы:
   - Преобразование токенов в символы для таблицы
   - Обработка ошибок разбора
   - Форматирование ошибок для пользователя

### Вспомогательные модули

1. **Таблица** (`Table`) - Структуры и функции для работы с таблицей парсинга
2. **Вывод контейнеров** (`PrintContainer`) - Функции для форматированного вывода

## Работа с грамматиками

### Форматирование правил грамматики

Грамматические правила должны быть записаны в определенном формате:
1. Для `GuidesBuilder` используется формат:
   ```
   <S> -> <E> #
   <E> -> <T> <E'>
   <E'> -> + <T> <E'> | e
   ```
   
2. Для `TableBuilder` правила должны содержать направляющие множества:
   ```
   <S> - <E> # / id int (
   <E> - <T> <E'> / id int (
   <E'> - + <T> <E'> / +
   ```

### Обработка специальных символов

При работе с грамматиками, содержащими специальные символы (такие как `-` и `/`), которые используются как в операторах, так и в синтаксисе правил, рекомендуется:

1. Использовать имена токенов вместо символов: `OP_PLUS` вместо `+`, `OP_MINUS` вместо `-`
2. Заменять имена токенов на символы после построения направляющих множеств
3. Для деталей см. документацию в `docs/parsing-notes.md`

## Тестирование

Проект включает полный набор тестов для всех компонентов. Тесты проверяют:
- Корректность работы лексического анализатора
- Правильность разбора выражений синтаксическим анализатором
- Точность построения направляющих множеств
- Правильность генерации таблицы для LL-парсера
- Корректную обработку входных данных LL-парсером

## Примеры использования

### Пример файла правил

```
<S> -> <E> #
<E> -> <T> <E'>
<E'> -> + <T> <E'> | - <T> <E'> | e
<T> -> <F> <T'>
<T'> -> * <F> <T'> | / <F> <T'> | e
<F> -> id | num | ( <E> )
```

### Пример выражения для парсинга

```
5 + 10 * 3 - (2 + 8)
``` 

### Пример тестирования парсера выражений

См. `test-expression-simple.ts` для примера тестирования парсера с грамматикой для математических выражений. 